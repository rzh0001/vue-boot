CREATE TABLE `pay_v2_product` (
	`id` VARCHAR (32) CHARACTER
	SET utf8 COLLATE utf8_general_ci NOT NULL,
	`product_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '产品代码',
 `product_name` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '产品名称',
 `status` INT (2) DEFAULT 1 COMMENT '状态 0：关闭；1：开启',
 `del_flag` INT (1) DEFAULT 0 COMMENT '删除状态，0:未删除，1删除状态',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`),
 UNIQUE KEY `ref_product_code` (`product_code`) USING BTREE
) ENGINE = INNODB DEFAULT CHARSET = utf8 COMMENT = '产品列表';

CREATE TABLE `pay_v2_channel` (
	`id` VARCHAR (32) CHARACTER
	SET utf8 COLLATE utf8_general_ci NOT NULL,
	`channel_name` VARCHAR (16) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道名称',
 `channel_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道代码',
 `channel_gateway` VARCHAR (64) DEFAULT NULL COMMENT '通道网关',
 `channel_ip` VARCHAR (64) DEFAULT NULL COMMENT '通道IP白名单，使用,分割',
 `channel_rate` VARCHAR (6) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道默认费率',
 `status` INT (2) DEFAULT 1 COMMENT '状态 0：关闭；1：开启',
 `del_flag` INT (1) DEFAULT 0 COMMENT '删除状态，0:未删除，1删除状态',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`),
 UNIQUE KEY `ref_channel_code` (`channel_code`) USING BTREE
) ENGINE = INNODB DEFAULT CHARSET = utf8 COMMENT = '通道信息';

CREATE TABLE `pay_v2_product_channel` (
	`id` INT (11) NOT NULL AUTO_INCREMENT,
	`product_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '产品代码',
 `channel_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道代码',
 `status` INT (2) DEFAULT 1 COMMENT '状态 0：关闭；1：开启',
 `del_flag` INT (1) DEFAULT 0 COMMENT '删除状态，0:未删除，1删除状态',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`)
) ENGINE = INNODB AUTO_INCREMENT = 55 DEFAULT CHARSET = utf8 COMMENT = '产品关联通道';

CREATE TABLE `pay_v2_user_product` (
	`id` VARCHAR (32) CHARACTER
	SET utf8 COLLATE utf8_general_ci NOT NULL,
	`user_name` VARCHAR (100) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '用户账号',
`agent_name` VARCHAR (100) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '代理',
`introducer_name` VARCHAR (100) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '介绍人',
 `member_type` VARCHAR (1) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '会员类型(1：代理  2：介绍人 3：商户）',
 `product_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '产品代码',
 `status` INT (2) DEFAULT 1 COMMENT '状态 0：关闭；1：开启',
 `del_flag` INT (1) DEFAULT 0 COMMENT '删除状态，0：未删除，1删除状态',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COMMENT = '用户关联产品列表';

CREATE TABLE `pay_v2_user_channel` (
	`id` VARCHAR (32) CHARACTER
	SET utf8 COLLATE utf8_general_ci NOT NULL,
	`user_name` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '用户名',
`agent_name` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '代理',
`introducer_name` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '介绍人',
 `member_type` VARCHAR (1) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '会员类型(1：代理  2：介绍人 3：商户）',
 `channel_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道code',
 `product_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '产品code',
 `user_rate` VARCHAR (10) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '费率',
 `upper_limit` DECIMAL (7, 2) DEFAULT NULL COMMENT '单笔金额上限',
 `lower_limit` DECIMAL (7, 2) DEFAULT NULL COMMENT '单笔金额下限',
 `del_flag` INT (1) DEFAULT 0 COMMENT '删除状态，0：未删除，1删除状态',
 `last_used_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '最近一次使用时间',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COMMENT = '用户关联通道信息';

CREATE TABLE `pay_v2_business` (
	`id` VARCHAR (32) CHARACTER
	SET utf8 COLLATE utf8_general_ci NOT NULL,
	`user_name` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '用户名',
 `channel_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '通道code',
 `product_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '产品code',
 `last_used_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '最近一次使用时间',
 `business_code` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '挂码账号',
 `business_api_key` VARCHAR (512) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '挂马账号apikey',
 `business_active_status` CHAR (1) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT '0' COMMENT '挂马账号是否激活 0:未激活；1：激活',
 `business_recharge_amount` DECIMAL (20, 2) DEFAULT '0.00' COMMENT '挂马账号充值金额',
 `business_income_amount` DECIMAL (20, 2) DEFAULT '0.00' COMMENT '挂马账号收入',
 `del_flag` INT (1) DEFAULT '0' COMMENT '删除状态，0：未删除，1删除状态',
 `create_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '创建人',
 `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
 `update_by` VARCHAR (32) CHARACTER
SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '更新人',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
 PRIMARY KEY (`id`)
) ENGINE = INNODB DEFAULT CHARSET = utf8 COMMENT = '子账号信息';


-- channel --
INSERT INTO pay_v2_channel (id,channel_name,channel_code,channel_gateway,channel_ip,channel_rate)
select REPLACE(UUID(), '-', ''),channel_name,channel_code,channel_gateway,channel_ip,0.003 from sys_channel;


-- product --
INSERT INTO pay_v2_product (id,product_code,product_name)
SELECT REPLACE(UUID(), '-', ''),product_code,product_name from pay_product;


-- pay_v2_product_channel --
INSERT INTO pay_v2_product_channel (product_code,channel_code)
select product_code,channel_code from pay_product_channel;


-- pay_v2_user_product --
INSERT INTO pay_v2_user_product (id,user_name,agent_name,introducer_name,member_type,product_code)
SELECT REPLACE(UUID(), '-', ''),c.user_name,u.agent_username,u.salesman_username,c.member_type,c.product_code from sys_user_channel c LEFT JOIN sys_user u ON c.user_name=u.username;


-- pay_v2_user_channel --
insert INTO pay_v2_user_channel (id,user_name,agent_name,introducer_name,member_type,channel_code,product_code,last_used_time,upper_limit,lower_limit)
SELECT REPLACE(UUID(), '-', ''),c.user_name,u.agent_username,u.salesman_username,c.member_type,c.channel_code,c.product_code,NOW(),c.upper_limit,c.lower_limit FROM sys_user_channel c LEFT JOIN sys_user u ON c.user_name=u.username WHERE product_code is NOT NULL;


-- pay_v2_business --

INSERT INTO pay_v2_business (id,user_name,channel_code,product_code,last_used_time,business_code,business_api_key,business_active_status,business_recharge_amount,business_income_amount)
SELECT REPLACE(UUID(), '-', ''),user_name,channel_code,product_code,NOW(),business_code,api_key,active,recharge_amount,income_amount FROM sys_user_business WHERE product_code is NOT NULL;

